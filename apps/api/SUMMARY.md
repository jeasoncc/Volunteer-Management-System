# å¯¼å‡ºåŠŸèƒ½å¼€å‘æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒåŠŸèƒ½å¼€å‘
- âœ… å¿—æ„¿è€…æœåŠ¡æ—¶é—´ç»Ÿè®¡è¡¨å¯¼å‡ºåŠŸèƒ½
- âœ… ç¬¦åˆæ·±åœ³å¿—æ„¿è€…ç®¡ç†ç³»ç»Ÿæ ¼å¼
- âœ… ä½¿ç”¨å¿—æ„¿è€…ç³»ç»Ÿä¹‰å·¥å·ï¼ˆvolunteer_idï¼‰
- âœ… è‡ªåŠ¨è®¡ç®—å·¥æ—¶ï¼ˆå•æ¬¡æ‰“å¡+1å°æ—¶ï¼Œæœ€å¤§8å°æ—¶/å¤©ï¼‰
- âœ… æ”¯æŒä»»æ„æ—¥æœŸèŒƒå›´ã€ç”¨æˆ·ç­›é€‰ã€æ´»åŠ¨åç§°

### 2. è„šæœ¬å·¥å…·
- âœ… `export-monthly.sh` - æœˆåº¦å¯¼å‡ºè„šæœ¬
- âœ… `export-batch.sh` - æ‰¹é‡å¯¼å‡ºè„šæœ¬
- âœ… `clean-exports.sh` - æ¸…ç†å¯¼å‡ºæ–‡ä»¶
- âœ… `verify-export.ts` - éªŒè¯å¯¼å‡ºæ–‡ä»¶
- âœ… `verify-export-detailed.ts` - è¯¦ç»†éªŒè¯
- âœ… `verify-monthly-exports.ts` - æœˆåº¦éªŒè¯
- âœ… `verify-max-hours.ts` - éªŒè¯å·¥æ—¶é™åˆ¶

### 3. npm scripts
å·²æ·»åŠ åˆ° package.jsonï¼š
```json
{
  "export:monthly": "bash scripts/export-monthly.sh",
  "export:batch": "bash scripts/export-batch.sh",
  "clean-exports": "bash scripts/clean-exports.sh",
  "export:verify": "bun run scripts/verify-monthly-exports.ts",
  "export:verify-detailed": "bun run scripts/verify-export-detailed.ts",
  "export:verify-hours": "bun run scripts/verify-max-hours.ts",
  "export:test": "bash scripts/test/test-export.sh",
  "generate-summary": "bun run scripts/generate-checkin-summary.ts"
}
```

### 4. æ–‡æ¡£ä½“ç³»
å·²åˆ›å»ºå®Œæ•´çš„æ–‡æ¡£ï¼š

**å¿«é€Ÿå…¥é—¨ï¼š**
- `docs/checkin/EXPORT_QUICK_REFERENCE.md` - å¿«é€Ÿå‚è€ƒ â­
- `docs/checkin/EXPORT_USAGE.md` - ä½¿ç”¨æŒ‡å—

**è¯¦ç»†æ–‡æ¡£ï¼š**
- `docs/checkin/EXPORT_RULES.md` - å¯¼å‡ºè§„åˆ™
- `docs/checkin/EXPORT_DATA_SOURCE.md` - æ•°æ®æ¥æºè¯´æ˜
- `docs/checkin/EXPORT_FAQ.md` - å¸¸è§é—®é¢˜
- `docs/checkin/EXPORT_COMPLETE_GUIDE.md` - å®Œæ•´æŒ‡å—
- `docs/checkin/EXPORT_GUIDE.md` - åŸºç¡€æŒ‡å—

**ç´¢å¼•å’Œå‚è€ƒï¼š**
- `docs/checkin/README.md` - è€ƒå‹¤ç®¡ç†æ–‡æ¡£ç´¢å¼•
- `docs/SCRIPTS_REFERENCE.md` - è„šæœ¬å‘½ä»¤å‚è€ƒ
- `exports/README.md` - å¯¼å‡ºæ–‡ä»¶è¯´æ˜

### 5. README æ›´æ–°
- âœ… æ·»åŠ è€ƒå‹¤ç®¡ç†åŠŸèƒ½ä»‹ç»
- âœ… æ·»åŠ å¯¼å‡ºåŠŸèƒ½è¯¦ç»†è¯´æ˜
- âœ… æ·»åŠ å¸¸ç”¨è„šæœ¬å‘½ä»¤
- âœ… æ·»åŠ æ–‡æ¡£é“¾æ¥

---

## ğŸ“Š åŠŸèƒ½ç‰¹æ€§

### å·¥æ—¶è®¡ç®—è§„åˆ™
1. **å•æ¬¡æ‰“å¡**: ç­¾é€€ = ç­¾åˆ° + 1å°æ—¶ï¼ŒæœåŠ¡æ—¶é•¿ = 1å°æ—¶
2. **å¤šæ¬¡æ‰“å¡**: ç­¾é€€ = æœ€åæ‰“å¡æ—¶é—´ï¼ŒæœåŠ¡æ—¶é•¿ = ç­¾é€€ - ç­¾åˆ°
3. **è·¨å¤©æ‰“å¡**: è‡ªåŠ¨å¤„ç†ï¼ˆç­¾é€€æ—¶é—´ < ç­¾åˆ°æ—¶é—´æ—¶åŠ 24å°æ—¶ï¼‰
4. **æœ€å¤§é™åˆ¶**: 8å°æ—¶/å¤©ï¼ˆè¶…è¿‡è‡ªåŠ¨é™åˆ¶ï¼‰

### Excel æ ¼å¼
```
ç¬¬1è¡Œï¼šæ·±åœ³å¿—æ„¿è€…ï¼ˆä¹‰å·¥ï¼‰æœåŠ¡æ—¶é—´ç»Ÿè®¡è¡¨ï¼ˆç”¨äºç»„ç»‡ç®¡ç†å‘˜å¯¼å…¥ç³»ç»Ÿï¼‰
ç¬¬2è¡Œï¼šåºå· | ä¹‰å·¥å·[çº¢] | å§“å | æ´»åŠ¨åç§° | æœåŠ¡å¼€å±•æ—¥æœŸ[çº¢] | ç­¾åˆ°æ—¶é—´[çº¢] | ç­¾é€€æ—¶é—´[çº¢] | æœåŠ¡æ—¶é•¿[çº¢]
æ•°æ®è¡Œï¼š1 | 0300207442 | é™ˆç’‹ | 2025.1101.1130ç”Ÿå‘½å…³æ€€ | 2025-11-15 | 12:00 | 13:00 | 1
```

### æ•°æ®æ¥æº
- ç›´æ¥ä» `volunteer_checkin` åŸå§‹æ‰“å¡è¡¨è·å–æ•°æ®
- å®æ—¶è®¡ç®—å·¥æ—¶ï¼Œä¸ä¾èµ–æ±‡æ€»è¡¨
- å¯ä»¥å¯¼å‡ºä»»æ„æ—¶é—´æ®µï¼ˆä¸é™äºä¸Šä¸ªæœˆï¼‰

---

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### å¯¼å‡ºå•ä¸ªæœˆä»½
```bash
npm run export:monthly 2025 11
```

### æ‰¹é‡å¯¼å‡º
```bash
npm run export:batch 2025 9 10 11
```

### æ¸…ç†æ–‡ä»¶
```bash
npm run clean-exports
```

### éªŒè¯æ–‡ä»¶
```bash
npm run export:verify-detailed
```

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ src/modules/checkin/
â”‚   â”œâ”€â”€ export.service.ts          # å¯¼å‡ºæœåŠ¡
â”‚   â”œâ”€â”€ summary.service.ts         # æ±‡æ€»æœåŠ¡
â”‚   â””â”€â”€ index.ts                   # è·¯ç”±å®šä¹‰
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ export-monthly.sh          # æœˆåº¦å¯¼å‡º
â”‚   â”œâ”€â”€ export-batch.sh            # æ‰¹é‡å¯¼å‡º
â”‚   â”œâ”€â”€ clean-exports.sh           # æ¸…ç†æ–‡ä»¶
â”‚   â”œâ”€â”€ verify-export.ts           # éªŒè¯å¯¼å‡º
â”‚   â”œâ”€â”€ verify-export-detailed.ts  # è¯¦ç»†éªŒè¯
â”‚   â”œâ”€â”€ verify-monthly-exports.ts  # æœˆåº¦éªŒè¯
â”‚   â””â”€â”€ verify-max-hours.ts        # éªŒè¯å·¥æ—¶
â”œâ”€â”€ exports/
â”‚   â”œâ”€â”€ README.md                  # å¯¼å‡ºæ–‡ä»¶è¯´æ˜
â”‚   â””â”€â”€ *.xlsx                     # å¯¼å‡ºçš„ Excel æ–‡ä»¶
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ SCRIPTS_REFERENCE.md       # è„šæœ¬å‚è€ƒ
â”‚   â””â”€â”€ checkin/
â”‚       â”œâ”€â”€ README.md              # æ–‡æ¡£ç´¢å¼•
â”‚       â”œâ”€â”€ EXPORT_QUICK_REFERENCE.md  # å¿«é€Ÿå‚è€ƒ
â”‚       â”œâ”€â”€ EXPORT_USAGE.md        # ä½¿ç”¨æŒ‡å—
â”‚       â”œâ”€â”€ EXPORT_RULES.md        # å¯¼å‡ºè§„åˆ™
â”‚       â”œâ”€â”€ EXPORT_DATA_SOURCE.md  # æ•°æ®æ¥æº
â”‚       â”œâ”€â”€ EXPORT_FAQ.md          # å¸¸è§é—®é¢˜
â”‚       â””â”€â”€ EXPORT_COMPLETE_GUIDE.md  # å®Œæ•´æŒ‡å—
â”œâ”€â”€ package.json                   # æ·»åŠ äº†å¯¼å‡ºç›¸å…³çš„ scripts
â”œâ”€â”€ README.md                      # æ›´æ–°äº†å¯¼å‡ºåŠŸèƒ½ä»‹ç»
â””â”€â”€ .gitignore                     # æ·»åŠ äº† exports/ å’Œ *.xlsx
```

---

## ğŸ“Š æµ‹è¯•æ•°æ®

### å·²å¯¼å‡ºçš„æ–‡ä»¶
| æ–‡ä»¶å | æœˆä»½ | å¿—æ„¿è€… | æ•°æ®è¡Œ | æ€»æ—¶é•¿ |
|--------|------|--------|--------|--------|
| å¿—æ„¿è€…æœåŠ¡æ—¶é—´ç»Ÿè®¡è¡¨_2025å¹´09æœˆ.xlsx | 2025å¹´9æœˆ | 17äºº | 150è¡Œ | 639.9å°æ—¶ |
| å¿—æ„¿è€…æœåŠ¡æ—¶é—´ç»Ÿè®¡è¡¨_2025å¹´10æœˆ.xlsx | 2025å¹´10æœˆ | 24äºº | 254è¡Œ | 933.0å°æ—¶ |
| å¿—æ„¿è€…æœåŠ¡æ—¶é—´ç»Ÿè®¡è¡¨_2025å¹´11æœˆ.xlsx | 2025å¹´11æœˆ | 25äºº | 157è¡Œ | 648.2å°æ—¶ |

### éªŒè¯ç»“æœ
- âœ… Excel æ ¼å¼æ­£ç¡®ï¼ˆMicrosoft Excel 2007+ï¼‰
- âœ… æ ‡é¢˜è¡Œå’Œè¡¨å¤´æ ¼å¼æ­£ç¡®
- âœ… æŒ‡å®šå­—æ®µæ ‡çº¢ï¼ˆä¹‰å·¥å·ã€æ—¥æœŸã€æ—¶é—´ã€æ—¶é•¿ï¼‰
- âœ… ä¹‰å·¥å·ä½¿ç”¨ volunteer_idï¼ˆå¦‚ 0300207442ï¼‰
- âœ… å•æ¬¡æ‰“å¡ç­¾é€€æ—¶é—´ = ç­¾åˆ°æ—¶é—´ + 1å°æ—¶
- âœ… å·¥æ—¶é™åˆ¶ä¸º8å°æ—¶/å¤©ï¼ˆ41æ¡è®°å½•è¢«é™åˆ¶ï¼‰

---

## ğŸ¯ è®¾è®¡å†³ç­–

### ä¸ºä»€ä¹ˆä¸ä½¿ç”¨æ±‡æ€»è¡¨ï¼Ÿ
**å†³å®š**: ç›´æ¥ä»åŸå§‹æ‰“å¡è¡¨ `volunteer_checkin` è·å–æ•°æ®

**ç†ç”±**:
1. âœ… å¯ä»¥å¯¼å‡ºä»»æ„æ—¶é—´æ®µï¼ˆä¸é™äºä¸Šä¸ªæœˆï¼‰
2. âœ… ä¸éœ€è¦ç­‰å¾…æ±‡æ€»è¡¨ç”Ÿæˆ
3. âœ… æ•°æ®å®æ—¶å‡†ç¡®
4. âœ… æ”¯æŒçµæ´»ç­›é€‰ï¼ˆç”¨æˆ·ã€æ—¥æœŸã€æ´»åŠ¨ï¼‰
5. âœ… ä»£ç ç®€å•ï¼Œç»´æŠ¤æˆæœ¬ä½

**æ€§èƒ½**: å¯¹äºæ­£å¸¸çš„æœˆåº¦æ•°æ®é‡ï¼ˆ< 1000æ¡ï¼‰ï¼Œæ€§èƒ½å®Œå…¨å¯æ¥å—ï¼ˆ< 1ç§’ï¼‰

### ä¸ºä»€ä¹ˆå•æ¬¡æ‰“å¡åŠ 1å°æ—¶ï¼Ÿ
**å†³å®š**: å•æ¬¡æ‰“å¡æ—¶ï¼Œç­¾é€€æ—¶é—´ = ç­¾åˆ°æ—¶é—´ + 1å°æ—¶

**ç†ç”±**:
1. ç¬¦åˆæ·±åœ³å¿—æ„¿è€…ç®¡ç†ç³»ç»Ÿè¦æ±‚
2. é¿å…ç­¾åˆ°å’Œç­¾é€€æ—¶é—´ç›¸åŒ
3. ç¬¦åˆå®é™…æœåŠ¡åœºæ™¯ï¼ˆè‡³å°‘æœåŠ¡1å°æ—¶ï¼‰

### ä¸ºä»€ä¹ˆé™åˆ¶8å°æ—¶ï¼Ÿ
**å†³å®š**: æ¯å¤©æœ€å¤§å·¥æ—¶é™åˆ¶ä¸º8å°æ—¶

**ç†ç”±**:
1. ç¬¦åˆæ·±åœ³å¿—æ„¿è€…ç®¡ç†ç³»ç»Ÿè¦æ±‚
2. ç¬¦åˆåŠ³åŠ¨æ³•è§„å®š
3. é¿å…å¼‚å¸¸æ•°æ®ï¼ˆå¦‚è®¾å¤‡æ•…éšœå¯¼è‡´çš„è¶…é•¿å·¥æ—¶ï¼‰

---

## ğŸ’¡ æœ€ä½³å®è·µ

### æœˆåº¦ä¸ŠæŠ¥æµç¨‹
```bash
# 1. æ¸…ç†æ—§æ–‡ä»¶
npm run clean-exports

# 2. å¯¼å‡ºä¸Šæœˆæ•°æ®
npm run export:monthly 2025 10

# 3. éªŒè¯æ•°æ®
npm run export:verify-detailed

# 4. ä¸Šä¼ åˆ°æ·±åœ³å¿—æ„¿è€…ç®¡ç†ç³»ç»Ÿ
```

### æ‰¹é‡å¯¼å‡ºæµç¨‹
```bash
# ä¸€æ¬¡æ€§å¯¼å‡ºå¤šä¸ªæœˆä»½
npm run export:batch 2025 9 10 11
```

---

## ğŸ“š æ–‡æ¡£é˜…è¯»é¡ºåº

### æ–°æ‰‹å…¥é—¨
1. [å¿«é€Ÿå‚è€ƒ](docs/checkin/EXPORT_QUICK_REFERENCE.md) - äº†è§£å¸¸ç”¨å‘½ä»¤
2. [ä½¿ç”¨æŒ‡å—](docs/checkin/EXPORT_USAGE.md) - å­¦ä¹ å¦‚ä½•ä½¿ç”¨
3. [å¸¸è§é—®é¢˜ FAQ](docs/checkin/EXPORT_FAQ.md) - è§£å†³å¸¸è§é—®é¢˜

### æ·±å…¥äº†è§£
1. [å¯¼å‡ºè§„åˆ™](docs/checkin/EXPORT_RULES.md) - ç†è§£å·¥æ—¶è®¡ç®—è§„åˆ™
2. [æ•°æ®æ¥æºè¯´æ˜](docs/checkin/EXPORT_DATA_SOURCE.md) - äº†è§£æ•°æ®è·å–é€»è¾‘
3. [å®Œæ•´æŒ‡å—](docs/checkin/EXPORT_COMPLETE_GUIDE.md) - æŒæ¡æ‰€æœ‰åŠŸèƒ½

---

## âœ… æ€»ç»“

### å·²å®ç°åŠŸèƒ½
- âœ… ç¬¦åˆæ·±åœ³å¿—æ„¿è€…ç®¡ç†ç³»ç»Ÿæ ¼å¼
- âœ… ä½¿ç”¨æ­£ç¡®çš„å¿—æ„¿è€…ç³»ç»Ÿä¹‰å·¥å·
- âœ… Excel ä¸¤è¡Œè¡¨å¤´ï¼ŒæŒ‡å®šå­—æ®µæ ‡çº¢
- âœ… è‡ªåŠ¨è®¡ç®—å·¥æ—¶ï¼ˆæ”¯æŒè·¨å¤©ï¼‰
- âœ… å•æ¬¡æ‰“å¡è‡ªåŠ¨æ·»åŠ 1å°æ—¶å‡æ—¶é•¿
- âœ… æœ€å¤§å·¥æ—¶é™åˆ¶ä¸º8å°æ—¶
- âœ… å¯¼å‡ºæ–‡ä»¶ç»Ÿä¸€ç®¡ç†åœ¨ exports/ æ–‡ä»¶å¤¹
- âœ… æ”¯æŒæ—¥æœŸèŒƒå›´ç­›é€‰
- âœ… æ”¯æŒæŒ‡å®šç”¨æˆ·å¯¼å‡º
- âœ… æ”¯æŒè‡ªå®šä¹‰æ´»åŠ¨åç§°
- âœ… å®Œæ•´çš„è„šæœ¬å·¥å…·å’Œæ–‡æ¡£ä½“ç³»

### æ ¸å¿ƒä¼˜åŠ¿
1. **å®æ—¶æ€§**: å¯ä»¥å¯¼å‡ºä»»æ„æ—¶é—´æ®µï¼Œä¸éœ€è¦ç­‰å¾…æ±‡æ€»
2. **çµæ´»æ€§**: æ”¯æŒå¤šç§ç­›é€‰å’Œè‡ªå®šä¹‰é€‰é¡¹
3. **å‡†ç¡®æ€§**: ç›´æ¥ä»åŸå§‹æ•°æ®è®¡ç®—ï¼Œé¿å…æ•°æ®ä¸ä¸€è‡´
4. **æ˜“ç”¨æ€§**: ç®€å•çš„å‘½ä»¤è¡Œå·¥å…·å’Œå®Œæ•´çš„æ–‡æ¡£

ğŸ‰ **å¯¼å‡ºåŠŸèƒ½å®Œå…¨å°±ç»ªï¼Œå¯ç›´æ¥ç”¨äºä¸Šä¼ æ·±åœ³å¿—æ„¿è€…ç®¡ç†ç³»ç»Ÿï¼**

---

**å¼€å‘æ—¶é—´**: 2024-11-16  
**ç»´æŠ¤è€…**: è²èŠ±æ–‹å¼€å‘å›¢é˜Ÿ
