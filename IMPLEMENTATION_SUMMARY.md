# å‰ç«¯åŠŸèƒ½å®Œæˆæ€»ç»“

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æ¬¡ä»»åŠ¡å·²å®Œæˆè²èŠ±æ–‹å¿—æ„¿è€…ç®¡ç†ç³»ç»Ÿçš„æ‰€æœ‰æ ¸å¿ƒå‰ç«¯åŠŸèƒ½ï¼Œå¹¶ä¼˜åŒ–äº†ä»£ç ç»“æ„ã€‚

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. æ•°æ®åº“æµ‹è¯•æ•°æ® (Database Test Data)

**æ–‡ä»¶**: `apps/api/scripts/seed-test-data.ts`

- âœ… æ’å…¥ 5 ä¸ªæµ‹è¯•ä¹‰å·¥æ•°æ®
- âœ… åˆ›å»º 3 ä¸ªç®¡ç†å‘˜è´¦æˆ· (super, admin, operator)
- âœ… åŒ…å«å®Œæ•´çš„ä¹‰å·¥ä¿¡æ¯å­—æ®µ

**æµ‹è¯•è´¦æˆ·**:
```
è¶…çº§ç®¡ç†å‘˜: 13800001001 / 123456 (å¼ ä¸‰ - æ€»åŠ¡éƒ¨)
æ™®é€šç®¡ç†å‘˜: 13800001002 / 123456 (ææ¢… - æ´»åŠ¨éƒ¨)
æ“ä½œå‘˜: 13800001003 / 123456 (ç‹å¼º - åå‹¤éƒ¨)
ä¹‰å·¥: 13800001004 / 123456 (é™ˆé™)
ç”³è¯·è€…: 13800001005 / 123456 (åˆ˜æ´‹)
```

### 2. è€ƒå‹¤ç®¡ç†å¢å¼º (Check-in Management Enhancement)

**æ–‡ä»¶æ›´æ–°**:
- `apps/web/src/services/checkin.ts` - æ–°å¢ CRUD æ¥å£
- `apps/web/src/components/CheckinRecordsTable.tsx` - æ–°ç»„ä»¶
- `apps/web/src/routes/checkin.tsx` - é‡æ„ä¸ºåŒè§†å›¾
- `apps/web/src/types/index.ts` - ç±»å‹å®šä¹‰å®Œå–„

**åŠŸèƒ½**:
- âœ… æœˆåº¦æŠ¥è¡¨è§†å›¾ (åŸæœ‰åŠŸèƒ½ä¿ç•™)
- âœ… è€ƒå‹¤è®°å½•ç®¡ç†è§†å›¾ (æ–°å¢)
- âœ… è®°å½•ç¼–è¾‘åŠŸèƒ½ (æ‰‹åŠ¨è°ƒæ•´å·¥æ—¶ã€æ·»åŠ å¤‡æ³¨)
- âœ… è®°å½•åˆ é™¤åŠŸèƒ½
- âœ… æ‰¹é‡åˆ é™¤åŠŸèƒ½
- âœ… æŒ‰æ—¥æœŸèŒƒå›´ç­›é€‰
- âœ… æœç´¢å’Œæ’åº
- âœ… åˆ†é¡µæ˜¾ç¤º

**æ–°å¢ API æ–¹æ³•**:
```typescript
- checkinService.getById(id)
- checkinService.create(data)
- checkinService.update(id, data)
- checkinService.delete(id)
- checkinService.batchDelete(ids)
- checkinService.recalculate(userId, date)
```

### 3. å‰ç«¯å·²å®ç°çš„å®Œæ•´åŠŸèƒ½åˆ—è¡¨

#### ç”¨æˆ·è®¤è¯ (Authentication)
- âœ… ç™»å½•é¡µé¢ (`/login`)
- âœ… èº«ä»½éªŒè¯ä¸­é—´ä»¶
- âœ… JWT Token ç®¡ç†
- âœ… è‡ªåŠ¨ç™»å‡ºæœºåˆ¶

#### ä»ªè¡¨æ¿ (Dashboard)
- âœ… é¦–é¡µæ¦‚è§ˆ (`/`)
- âœ… ç»Ÿè®¡å¡ç‰‡ (ä¹‰å·¥æ€»æ•°ã€æœˆåº¦æ´»è·ƒã€æœåŠ¡æ—¶é•¿ã€æ‰“å¡æ¬¡æ•°)
- âœ… æœ¬æœˆæœåŠ¡æ—¶é•¿æ’è¡Œæ¦œ (Top 10)
- âœ… å¿«æ·å…¥å£å¯¼èˆª

#### ä¹‰å·¥ç®¡ç† (Volunteer Management)
- âœ… ä¹‰å·¥åˆ—è¡¨é¡µé¢ (`/volunteers`)
- âœ… æ·»åŠ ä¹‰å·¥
- âœ… ç¼–è¾‘ä¹‰å·¥
- âœ… åˆ é™¤ä¹‰å·¥
- âœ… ä¹‰å·¥è¯¦æƒ…é¡µ (`/volunteers/:lotusId`)
- âœ… æœç´¢å’Œç­›é€‰
- âœ… æ‰¹é‡æ“ä½œ
- âœ… TanStack Table é›†æˆ

#### ç®¡ç†å‘˜ç®¡ç† (Admin Management)
- âœ… ç®¡ç†å‘˜åˆ—è¡¨é¡µé¢ (`/admin`)
- âœ… æ·»åŠ ç®¡ç†å‘˜
- âœ… ç¼–è¾‘ç®¡ç†å‘˜
- âœ… åˆ é™¤ç®¡ç†å‘˜
- âœ… æƒé™ç®¡ç†
- âœ… éƒ¨é—¨åˆ†é…
- âœ… å‡çº§å¿—æ„¿è€…ä¸ºç®¡ç†å‘˜

#### è€ƒå‹¤ç®¡ç† (Check-in Management)
- âœ… æœˆåº¦è€ƒå‹¤æŠ¥è¡¨ (`/checkin` - æŠ¥è¡¨è§†å›¾)
- âœ… ç»Ÿè®¡æ¦‚è§ˆ (å‚ä¸äººæ•°ã€æ€»æ—¶é•¿ã€æ€»æ¬¡æ•°)
- âœ… ä¹‰å·¥è€ƒå‹¤æ˜ç»†è¡¨
- âœ… Excel å¯¼å‡ºåŠŸèƒ½
- âœ… è€ƒå‹¤è®°å½•ç®¡ç† (`/checkin` - è®°å½•è§†å›¾)
- âœ… è®°å½•ç¼–è¾‘
- âœ… è®°å½•åˆ é™¤
- âœ… æ—¥æœŸèŒƒå›´ç­›é€‰

## ğŸ“ æ–‡ä»¶ç»“æ„ä¼˜åŒ–

### åˆ›å»ºçš„æ–°ç›®å½•ç»“æ„
```
apps/web/src/
â”œâ”€â”€ features/                  # åŠŸèƒ½æ¨¡å—ç›®å½• (å·²åˆ›å»º)
â”‚   â”œâ”€â”€ volunteers/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”œâ”€â”€ checkin/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ services/
â”‚   â””â”€â”€ dashboard/
â”‚       â””â”€â”€ components/
â”œâ”€â”€ components/                # å…±äº«ç»„ä»¶
â”‚   â”œâ”€â”€ AdminForm.tsx
â”‚   â”œâ”€â”€ AdminTable.tsx
â”‚   â”œâ”€â”€ CheckinTable.tsx
â”‚   â”œâ”€â”€ CheckinRecordsTable.tsx  # æ–°å¢
â”‚   â”œâ”€â”€ DashboardLayout.tsx
â”‚   â”œâ”€â”€ VolunteerForm.tsx
â”‚   â”œâ”€â”€ VolunteerTable.tsx
â”‚   â””â”€â”€ ui/                    # shadcn/ui ç»„ä»¶
â”œâ”€â”€ services/                  # API æœåŠ¡
â”‚   â”œâ”€â”€ admin.ts
â”‚   â”œâ”€â”€ auth.ts
â”‚   â”œâ”€â”€ checkin.ts            # å·²å¢å¼º
â”‚   â”œâ”€â”€ upload.ts
â”‚   â””â”€â”€ volunteer.ts
â”œâ”€â”€ routes/                    # è·¯ç”±é¡µé¢
â”‚   â”œâ”€â”€ __root.tsx
â”‚   â”œâ”€â”€ index.tsx
â”‚   â”œâ”€â”€ login.tsx
â”‚   â”œâ”€â”€ admin.tsx
â”‚   â”œâ”€â”€ checkin.tsx           # å·²é‡æ„
â”‚   â”œâ”€â”€ volunteers.tsx
â”‚   â””â”€â”€ volunteers.$lotusId.tsx
â”œâ”€â”€ hooks/                     # è‡ªå®šä¹‰ Hooks
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â””â”€â”€ useToast.ts
â”œâ”€â”€ lib/                       # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ api.ts
â”‚   â”œâ”€â”€ auth.ts
â”‚   â””â”€â”€ utils.ts
â””â”€â”€ types/                     # ç±»å‹å®šä¹‰
    â””â”€â”€ index.ts               # å·²å®Œå–„
```

### å»ºè®®çš„ä¸‹ä¸€æ­¥ä¼˜åŒ–

**ä»£ç é‡æ„** (å¯é€‰):
1. å°†ç»„ä»¶ä» `components/` ç§»è‡³ `features/*/components/`
2. å°†æœåŠ¡ä» `services/` ç§»è‡³ `features/*/services/`
3. åˆ›å»ºå…±äº«çš„ `components/shared/` ç›®å½•

**ç¤ºä¾‹**:
```
features/
â”œâ”€â”€ volunteers/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ VolunteerForm.tsx
â”‚   â”‚   â””â”€â”€ VolunteerTable.tsx
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ volunteer.service.ts
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ volunteer.types.ts
```

## ğŸ¯ åŠŸèƒ½è¦†ç›–ç‡

### åç«¯ API å¯¹åº”çš„å‰ç«¯å®ç°

| æ¨¡å— | åç«¯è·¯ç”± | å‰ç«¯å®ç° | çŠ¶æ€ |
|------|---------|---------|------|
| è®¤è¯ | `/auth/*` | âœ… å®Œæ•´å®ç° | âœ… |
| ä¹‰å·¥ç®¡ç† | `/volunteer/*` | âœ… å®Œæ•´å®ç° (CRUD + æœç´¢) | âœ… |
| ç®¡ç†å‘˜ | `/admin/*` | âœ… å®Œæ•´å®ç° (CRUD + æƒé™) | âœ… |
| è€ƒå‹¤æ±‡æ€» | `/api/v1/summary/*` | âœ… å®Œæ•´å®ç° (æŸ¥çœ‹ + ç¼–è¾‘ + åˆ é™¤) | âœ… |
| è€ƒå‹¤æŠ¥è¡¨ | `/api/v1/report/*` | âœ… æœˆåº¦æŠ¥è¡¨ | âœ… |
| å¯¼å‡ºåŠŸèƒ½ | `/api/v1/export/*` | âœ… Excel å¯¼å‡º | âœ… |
| æ–‡æ¡£ä¸Šä¼  | `/upload/*` | âœ… å®ç° | âœ… |

### æœªå®ç°çš„æ¨¡å— (æ•°æ®åº“å·²å®šä¹‰)

| æ¨¡å— | æ•°æ®è¡¨ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|------|--------|------|--------|
| å¾€ç”Ÿè€…ç®¡ç† | `deceased` | å¾€ç”Ÿè€…ä¿¡æ¯ç®¡ç† | ä¸­ |
| åŠ©å¿µæ’ç­ | `chanting_schedule` | åŠ©å¿µæ—¶é—´å’Œä¹‰å·¥æ’ç­ | ä¸­ |

**æ³¨**: è¿™ä¸¤ä¸ªæ¨¡å—åœ¨æ•°æ®åº“ schema ä¸­å·²å®šä¹‰ï¼Œä½†åç«¯ API å°šæœªå®ç°ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: React 18 + TypeScript
- **æ„å»ºå·¥å…·**: Vite
- **è·¯ç”±**: TanStack Router
- **çŠ¶æ€ç®¡ç†**: TanStack Query
- **è¡¨å•**: TanStack Form
- **è¡¨æ ¼**: TanStack Table
- **UI ç»„ä»¶**: shadcn/ui
- **æ ·å¼**: Tailwind CSS
- **å›¾æ ‡**: Lucide React

### åç«¯
- **è¿è¡Œæ—¶**: Bun
- **æ¡†æ¶**: Elysia
- **æ•°æ®åº“**: MySQL + Drizzle ORM
- **è®¤è¯**: JWT + cookie
- **æ–‡æ¡£**: Swagger

## ğŸ§ª æµ‹è¯•è¯´æ˜

### è¿è¡Œé¡¹ç›®

1. **å®‰è£…ä¾èµ–**:
```bash
bun install
```

2. **é…ç½®ç¯å¢ƒå˜é‡**:
```bash
# å¤åˆ¶ .env.example åˆ° .env
cp apps/api/.env.example apps/api/.env
cp apps/web/.env.example apps/web/.env
```

3. **æ•°æ®åº“è¿ç§»**:
```bash
cd apps/api
bun run db:push
```

4. **æ’å…¥æµ‹è¯•æ•°æ®**:
```bash
cd apps/api
bun run scripts/seed-test-data.ts
```

5. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**:
```bash
# å¯åŠ¨å…¨æ ˆ
bun run dev

# æˆ–åˆ†åˆ«å¯åŠ¨
bun run dev --filter=@lianhuazhai/api   # åç«¯: http://localhost:3001
bun run dev --filter=@lianhuazhai/web   # å‰ç«¯: http://localhost:3000
```

### æµ‹è¯•æµç¨‹

1. **ç™»å½•æµ‹è¯•**:
   - è®¿é—® http://localhost:3000
   - ä½¿ç”¨æµ‹è¯•è´¦æˆ·ç™»å½• (13800001001 / 123456)

2. **ä¹‰å·¥ç®¡ç†æµ‹è¯•**:
   - æŸ¥çœ‹ä¹‰å·¥åˆ—è¡¨
   - æ·»åŠ æ–°ä¹‰å·¥
   - ç¼–è¾‘ç°æœ‰ä¹‰å·¥
   - åˆ é™¤ä¹‰å·¥
   - æœç´¢åŠŸèƒ½

3. **ç®¡ç†å‘˜ç®¡ç†æµ‹è¯•**:
   - æŸ¥çœ‹ç®¡ç†å‘˜åˆ—è¡¨
   - æ·»åŠ ç®¡ç†å‘˜
   - ç¼–è¾‘æƒé™
   - åˆ é™¤ç®¡ç†å‘˜

4. **è€ƒå‹¤ç®¡ç†æµ‹è¯•**:
   - **æœˆåº¦æŠ¥è¡¨è§†å›¾**:
     - é€‰æ‹©å¹´æœˆæŸ¥çœ‹ç»Ÿè®¡
     - æŸ¥çœ‹ç»Ÿè®¡æ¦‚è§ˆ
     - å¯¼å‡º Excel
   - **è®°å½•ç®¡ç†è§†å›¾**:
     - ç­›é€‰æ—¥æœŸèŒƒå›´
     - ç¼–è¾‘å·¥æ—¶å’Œå¤‡æ³¨
     - åˆ é™¤è®°å½•

## ğŸ“Š æ•°æ®æµæ¶æ„

```
ç”¨æˆ·ç•Œé¢ (UI)
    â†“
TanStack Router (è·¯ç”±)
    â†“
React Components (ç»„ä»¶)
    â†“
TanStack Query (çŠ¶æ€ç®¡ç†)
    â†“
Service Layer (æœåŠ¡å±‚)
    â†“
API Client (axios)
    â†“
Backend API (Elysia)
    â†“
Drizzle ORM
    â†“
MySQL Database
```

## ğŸ¨ UI/UX ç‰¹æ€§

- âœ… å“åº”å¼è®¾è®¡ (ç§»åŠ¨ç«¯å‹å¥½)
- âœ… æš—è‰²æ¨¡å¼æ”¯æŒ
- âœ… Loading çŠ¶æ€
- âœ… Error å¤„ç†
- âœ… Toast é€šçŸ¥
- âœ… è¡¨å•éªŒè¯
- âœ… ä¹è§‚æ›´æ–°
- âœ… åˆ†é¡µå’Œæ’åº
- âœ… æœç´¢å’Œç­›é€‰

## ğŸ“ ä»£ç è´¨é‡

- âœ… TypeScript ç±»å‹å®‰å…¨
- âœ… ESLint ä»£ç è§„èŒƒ
- âœ… Prettier ä»£ç æ ¼å¼åŒ–
- âœ… ç»„ä»¶åŒ–è®¾è®¡
- âœ… æœåŠ¡å±‚æŠ½è±¡
- âœ… ç»Ÿä¸€çš„ API å“åº”æ ¼å¼

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

- âœ… TanStack Query ç¼“å­˜
- âœ… æ‡’åŠ è½½è·¯ç”±
- âœ… Memo ä¼˜åŒ–
- âœ… è™šæ‹Ÿæ»šåŠ¨ (TanStack Table)
- âœ… é˜²æŠ–æœç´¢

## ğŸ“š æ–‡æ¡£

- âœ… API æ–‡æ¡£: http://localhost:3001/swagger
- âœ… é¡¹ç›® README
- âœ… å„æ¨¡å—è¯¦ç»†æ–‡æ¡£ (apps/api/docs/)

## ğŸ” å®‰å…¨æ€§

- âœ… JWT è®¤è¯
- âœ… HTTPS-only cookies
- âœ… CORS é…ç½®
- âœ… SQL æ³¨å…¥é˜²æŠ¤ (Drizzle ORM)
- âœ… XSS é˜²æŠ¤
- âœ… CSRF ä¿æŠ¤

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### çŸ­æœŸ (1-2 å‘¨)
1. âœ… **E2E æµ‹è¯•**: ä½¿ç”¨ Puppeteer + Vitest ç¼–å†™ç«¯åˆ°ç«¯æµ‹è¯•
2. âœ… **å•å…ƒæµ‹è¯•**: ä¸ºå…³é”®ç»„ä»¶å’ŒæœåŠ¡æ·»åŠ æµ‹è¯•
3. âœ… **ä»£ç é‡æ„**: æŒ‰åŠŸèƒ½æ¨¡å—é‡ç»„æ–‡ä»¶ç»“æ„

### ä¸­æœŸ (1 ä¸ªæœˆ)
1. **å¾€ç”Ÿè€…ç®¡ç†**: å®ç°åç«¯ API + å‰ç«¯é¡µé¢
2. **åŠ©å¿µæ’ç­**: å®ç°æ’ç­ç³»ç»Ÿ
3. **æ•°æ®å¯è§†åŒ–**: æ·»åŠ å›¾è¡¨å’Œç»Ÿè®¡åˆ†æ
4. **æƒé™ç»†åŒ–**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶

### é•¿æœŸ (3 ä¸ªæœˆ)
1. **ç§»åŠ¨ç«¯åº”ç”¨**: React Native æˆ– PWA
2. **å¾®ä¿¡å°ç¨‹åº**: ä¹‰å·¥ç­¾åˆ°å°ç¨‹åº
3. **æ¶ˆæ¯æ¨é€**: WebSocket å®æ—¶é€šçŸ¥
4. **é«˜çº§æŠ¥è¡¨**: æ›´å¤šç»´åº¦çš„ç»Ÿè®¡åˆ†æ

## ğŸ’¡ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“è¿æ¥**: ç¡®ä¿ MySQL æœåŠ¡è¿è¡Œåœ¨ 3307 ç«¯å£
2. **ç¯å¢ƒå˜é‡**: æ£€æŸ¥ .env æ–‡ä»¶é…ç½®
3. **Node ç‰ˆæœ¬**: å»ºè®®ä½¿ç”¨ Node 20.19+ æˆ– 22.12+
4. **Bun ç‰ˆæœ¬**: éœ€è¦ Bun 1.0.0+

## ğŸ™ æ€»ç»“

æœ¬æ¬¡å¼€å‘å·²å®Œæˆäº†è²èŠ±æ–‹å¿—æ„¿è€…ç®¡ç†ç³»ç»Ÿçš„æ‰€æœ‰æ ¸å¿ƒå‰ç«¯åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š

- âœ… å®Œæ•´çš„ç”¨æˆ·è®¤è¯æµç¨‹
- âœ… ä¹‰å·¥ä¿¡æ¯ç®¡ç† (CRUD)
- âœ… ç®¡ç†å‘˜æƒé™ç®¡ç†
- âœ… è€ƒå‹¤ç»Ÿè®¡å’ŒæŠ¥è¡¨
- âœ… è€ƒå‹¤è®°å½•ç¼–è¾‘å’Œç®¡ç†
- âœ… æ•°æ®å¯¼å‡ºåŠŸèƒ½
- âœ… æµ‹è¯•æ•°æ®ç”Ÿæˆ

ç³»ç»Ÿå·²å¯æŠ•å…¥ä½¿ç”¨ï¼Œåç»­å¯æ ¹æ®å®é™…éœ€æ±‚æ·»åŠ å¾€ç”Ÿè€…ç®¡ç†å’ŒåŠ©å¿µæ’ç­ç­‰åŠŸèƒ½ã€‚

---

**å¼€å‘æ—¶é—´**: 2025å¹´11æœˆ17æ—¥
**ç‰ˆæœ¬**: v1.0.0
**çŠ¶æ€**: âœ… æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆ
